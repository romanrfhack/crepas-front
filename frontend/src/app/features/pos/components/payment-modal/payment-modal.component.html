<section class="modal" aria-label="Cobro de venta">
  <div class="modal-card">
    <h3>ðŸ’° Cobrar</h3>

    <div class="total-row">
      <span class="total-label">Total a pagar</span>
      <span class="total-amount">${{ total().toFixed(2) }}</span>
    </div>

    <div class="form-group">
      <label for="payment-method">MÃ©todo de pago</label>
      <select
        id="payment-method"
        [value]="method()"
        (change)="selectMethod($any($event.target).value)"
      >
        <option value="Cash">Efectivo</option>
        <option value="Card">Tarjeta</option>
        <option value="Transfer">Transferencia</option>
      </select>
    </div>

    @if (method() === 'Cash') {
      <div class="form-group">
        <label for="received-amount">RecibÃ­</label>
        <input
          id="received-amount"
          type="number"
          min="0"
          step="0.01"
          placeholder="0.00"
          [value]="receivedAmount()"
          (input)="updateReceivedAmount(+$any($event.target).value || 0)"
        />
      </div>

      <div class="cash-feedback">
        <div class="change-row">
          <span>Cambio</span>
          <strong>${{ changeAmount().toFixed(2) }}</strong>
        </div>
        @if (insufficientCash()) {
          <p class="error" role="alert">
            El monto recibido debe ser mayor o igual al total
          </p>
        }
      </div>
    }

    @if (method() === 'Transfer' || method() === 'Card') {
      <div class="form-group">
        <label for="payment-reference">Referencia (opcional)</label>
        <input
          id="payment-reference"
          type="text"
          [value]="reference()"
          (input)="updateReference($any($event.target).value)"
          placeholder="NÃºmero de voucher, folio, etc."
        />
      </div>
    }

    <div class="modal-actions">
      <button type="button" (click)="cancelAction.emit()">Cancelar</button>
      <button
        type="button"
        [disabled]="loading() || insufficientCash()"
        (click)="confirmPayment()"
      >
        <span>âœ…</span> Confirmar cobro
      </button>
    </div>
  </div>
</section>